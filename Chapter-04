
# Inject istio sidecar.

# Inject istio side card to namespace.
# Inject istio side card to application.

Note: ServiceMesh does not automatically inject the sidevar into everypod. you must specify which pods or applications must be managed by serviceMesh. for this add additional annotations on the deployment.



# Create gataway
# Create virtualservice

...

sidecar.istio.io/inject=true

...

Deployment:
...
spec:
  replicas: 1
  template:
    metadata:
      labels:
        app: history
      annotations:
        sidecar.istio.io/inject: "true"
    spec:
      containers:
        - name: history
          image: quay.io/redhattraining/ossm-history:1.0
...


Envoy Sidecar are 2 types.
- Ingress side card
- Egress side card

$ oc get deployment -n istio-system
  - istio-ingressgateway
  - istio-ingressgateway

$ oc get route -n istio-system
  you will find ingress gateway 


.....


Pratical.


1) Create a new project
$ oc new-project hello
$ oc describe ns hello

2) Add ns to smmr 
$ oc get smmr (0/0)
$ oc edit smmr -n istio-system
spec:
  members:
  - hello

$ oc get smmr (1/1)
$ oc describe smmr -n istio-system
$ oc describe ns hello

3) Deploy the application (Deployment and service)
4) Add istio side card to your deployment.

...
spec:
  replicas: 1
  template:
    metadata:
      labels:
        app: history
      annotations:
        sidecar.istio.io/inject: "true"
    spec:
      containers:
...





